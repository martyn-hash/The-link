Comms Workflow Planning Brief for The Link
Role‚Ä®You are acting as a senior product architect and systems designer.
Your task is to produce a clear, structured planning document (not code) for building an advanced Communications Workflow system inside The Link.
The goal is to transform email from a passive inbox into an active, zero-backlog workflow where emails behave like micro-tasks.

1Ô∏è‚É£ Customer Gate (Hard Filter ‚Äì First Step)
Design a customer gate that ensures only relevant emails enter the system.
Rules:
* Only ingest emails where:
    * sender.email OR
    * any cc.email
* matches:
    * a client email address or
    * a known person (contact) linked to a client in The Link.
* All other emails are ignored or quarantined (out of scope for this system).
Document:
* Matching logic
* Fallbacks
* Edge cases (e.g. shared inboxes, forwarded emails)

NOTE on step 1: We need a ‚ÄòDev Override on this, so I can continue to bring my whole inbox to test on large amounts of data. 


2Ô∏è‚É£ Deterministic Pre-Classification Layer (Non-AI)
Before any AI is used, apply a deterministic rules engine that sets a minimum handling floor.
Rules to include (at minimum):
* Question marks
* Explicit request phrases (‚Äúcan you‚Äù, ‚Äúplease advise‚Äù, ‚Äúplease confirm‚Äù)
* Attachments present
* Deadline phrases (‚ÄúASAP‚Äù, dates, ‚Äúby Friday‚Äù)
* Acknowledgements only (‚Äúthanks‚Äù, ‚Äúnoted‚Äù, ‚Äúall good‚Äù)
This layer must:
* Be deterministic and explainable
* Output minimum guarantees
* Never downgrade importance later
Define:
* requires_task_floor
* requires_reply_floor
* Triggered rule list
* Explanation

3Ô∏è‚É£ AI Classification (OpenAI 4o-mini)
After deterministic filtering, strip the email down to a minimal JSON payload and send it to OpenAI 4o-mini for classification.
AI must classify (true/false, multiple allowed unless stated):
* requires_task
* requires_reply
* sentiment (positive / neutral / negative - make this a fixed, but detailed list, maybe a score between -1 to 1?
* opportunity (upsell, follow-up, commercial opportunity - create a more detailed fixed list)
* urgency
* information_only
Rules:
* Emails may be true in multiple categories
* EXCEPTION:‚Ä®If information_only = true, it must be exclusive (no other categories true)
Document:
* Merge logic between deterministic floor and AI output
* Conflict resolution (most conservative result wins)

4Ô∏è‚É£ Comms Workspace ‚Äì Toolbar & Slicing
Design toolbar buttons in the Comms workspace that slice emails by classification, e.g.:
* Requires Task
* Requires Reply
* Urgent
* Opportunities
* Information Only
* All / Outstanding
These are workflow views, not filters buried in a sidebar.

5Ô∏è‚É£ Email as Workflow (Micro-Tasks)
Redesign email presentation so emails are:
* micro-tasks
* explicitly worked, not passively read
Core behaviour:
* Emails must be checked off to disappear
* Inbox goal = zero entries

6Ô∏è‚É£ Task Enforcement Rules (Critical)
Rules:
* If requires_task = true, the email cannot be completed until:
    * the user explicitly marks ‚Äúno task required‚Äù OR
    * a task has been created and completed
* Provide one-click ‚ÄúCreate Task‚Äù:
    * Pre-populate task form with:
        * client
        * summary
        * suggested description
        * due date (if inferred)
        * related email 

7Ô∏è‚É£ Reply Enforcement
Rules:
* If requires_reply = true:
    * The email micro-task is marked complete only when a reply is sent
* Reply detection logic should be documented.

8Ô∏è‚É£ SLA & Performance Tracking
Design SLA tracking for:
* All emails where requires_reply = true
Include:
* Time received ‚Üí time replied
* Breach detection
* Aggregation by user, client, team

9Ô∏è‚É£ Manual Overrides & Auditability
Users must be able to:
* Add or remove classifications manually
* Example:
    * information_only = true ‚Üí removed
    * requires_reply = true ‚Üí added
System must:
* Track overrides
* Record who changed what and why
* Re-evaluate completion rules after changes

1Ô∏è‚É£ 0Ô∏è‚É£ Retro Adding of Emails
Users must be able to get emails into the system that did not make it past 1Ô∏è‚É£ Customer Gate (Hard Filter)
- For example, a client changes their email address, or a new person joins their team etc. 
- So there need to be some ability to query the whole inbox through graph and bring other emails into the system. 

üéØ Core Objective 
The primary outcome of this system is:
Allow users to allocate focused, productive time to communications, with the explicit goal of reducing the Comms view to zero entries by consciously working and completing email-tasks.
This is workflow management, not inbox management.

üìÑ Deliverable Required From You
Produce a planning document that includes:
* Architecture overview
* Data flow (high level)
* State transitions for an email
* UI/UX behaviour descriptions
* Edge cases and failure modes
* Clear separation of responsibilities (rules vs AI vs human)
Do not write code.‚Ä®Do not implement.‚Ä®Plan only.