I want you to help me plan and implement a notification & reminder system for clients (not staff). 

The point of this system is to send emails, SMS messages & push messages to clients in relation to the projects we deliver for them. 

For your context, the real world scenario here is that we'll want to tell the client to take certain actions, like send us documents for bookkeeping, or provide information for accounts etc. 

Here's how I see it working: 

When a staff user is creating the Project Type, we'd have a new 'Notifications' section. 

In this section, the user should be able to add a 'notification'.

We'd have 2 'Notification Categories': 

Project Notifications
Stage Notifications 


Project Notifications Explained:

The user would select if it's an email / sms / push (notification type)
The user should pick if the notification relates to the 'start date' or 'due date' and then specify if the notification should be sent before, on, or after by n days.

The SMS should be capped at 160 characters. 
The Push should be capped at n characters, with n being whatever is a reasonable amount of characters for push. 
The email does not need a cap, but should support title & body with a rich text editor


If the notification type is push or email, the user should have the ability to connect a 'Client Request Template' (for example the bookkeeping project is due to start in 5 days, so we send the client a project notification linked to a Client Request that asks for up to date sales invoices and receipts)

If the project notification is linked to a Client Request this should be created for client in the client portal in the same way as it would be usually, and opened via the push message, or a link in the email. 

If a Client Request Template is attached, then the user should be further able to define a 'Client Request Reminder' (which since these relate to both 'Project Notifications' and 'Stage Notifications', I will provide the brief for these further down). 

Stage Notifications Explained: 

The user would pick the notification type
The user would pick the project stage
The user picks if the notification is triggered by a stage being entered or the stage being exited 

The same caps / detail (SMS- 160char, Push- nChar, Email- title, body, rich text editor)

The same ability to link Client Request Templates to push and email should apply. 

Client Request Reminders Explained: 

If a Client Request Reminder has been selected because a Client Request Template has been attached to either Project Notification or a Stage Notification, then the process is very similar is to creating Project Notification, except the user can only set days after the Client Template was created, and no further Client Request Templates can be applied, so: 

User picks Notification Type. 
User picks how many days after the Client Request was sent to send the Reminder

IMPORTANT: The sequence for Request Reminders should be stopped if the associated Client Request is submitted by the Client User, or if the staff user marks to say no further reminders. 

Which bring me to: 

1. There needs to be an admin view - 'Scheduled Notifications', perhaps visible as a list and/ or a calendar that can be filtered by Project, Client that shows all the notifications and reminders due to go out of the system and has the ability to cancel them individually or in bulk by selecting them (for example, a client might get super angry that we keeo reminding them about a Client Request that needs completing, if they call the office and say it will be delayed as they are going on holiday etc) and then the system still keeps pumping reminders. 

Other Notes: 

Use Sendgrid to send the emails. 
Allow a field for Sender Name for emails to be defined - perhaps somewhere in a new 'Company Settings' page in the Super Admin area
I think you'll have to think through how the notifications are initially created, I would imagine that the first set of notifications for a particular client will need to be created when the service is added to the client - as although the notifications will be mapped to projects, the +/- days of the start and due dates will ultimately be driven by the Service dates that have been associated with the client. 


For the next update to the notification and reminder system, we will: 

1) Show the notifications that will go out for a client and the dates these will go out, at the point a Service is added to a client. 
2) When the user is adding a service to a client that has notifications set up, the user should be able to specify which related people will get the notifications & reminders. 
3) When a project is being moved into or out of a stage that would trigger a notification, we should prompt the user with the details or the notification(s) along with the copy and allow the user to decide if some notifications are not sent, to edit the ones that are there, and approve them to go out. 
4) Add the dates of the notifications and which for which Projects they are for the client user will receive to the client user portal, and give the client user the ability to turn some off. 
5) Show a version of the 'Scheduled Notifications' in the Client Detail view that have all notifications scheduled and all Client Template Reminders that are due, with support for disabling them individually or in bulk. 
6) If a Service is removed or dates modified for a client, then notifications or reminders are should be removed, or have their dates updated accordingly, this also applies to if there are any changes delivered via companies house. 


Please just note in your plan that if you wish to perform browser testing, you'll need to login via the root page, password tab, using 'admin@example.com' | 'admin123'. 


